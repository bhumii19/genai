from scipy.linalg import sqrtm
import numpy as np

def calculate_fid(mu1, sigma1, mu2, sigma2):
    diff = mu1 - mu2
    covmean = sqrtm(sigma1.dot(sigma2))
    fid = diff.dot(diff) + np.trace(sigma1 + sigma2 - 2 * covmean)
    return np.real(fid)

mu1, sigma1 = np.random.rand(3), np.eye(3)
mu2, sigma2 = np.random.rand(3), np.eye(3)

print("FID Score:", calculate_fid(mu1, sigma1, mu2, sigma2))


THEORY -

### 1. What is FID?

* **FID (Fr√©chet Inception Distance)** is a metric to evaluate the quality of images generated by Generative AI models (GANs, Diffusion, etc.).
* It compares the **distribution of generated images** with the **distribution of real images**.
* Lower FID ‚Üí generated images are closer to real ones (better quality).

---

### 2. Mathematical Definition

FID is computed as the distance between two **multivariate Gaussian distributions**:

* Real images ‚Üí mean = Œº‚ÇÅ, covariance = Œ£‚ÇÅ
* Generated images ‚Üí mean = Œº‚ÇÇ, covariance = Œ£‚ÇÇ

Formula:

$$
FID = ||\mu_1 - \mu_2||^2 + \text{Tr}(\Sigma_1 + \Sigma_2 - 2\sqrt{\Sigma_1 \Sigma_2})
$$

---

### 3. About the Code

1. **FID Function**

   ```python
   def calculate_fid(mu1, sigma1, mu2, sigma2):
       diff = mu1 - mu2
       covmean = sqrtm(sigma1.dot(sigma2))
       fid = diff.dot(diff) + np.trace(sigma1 + sigma2 - 2 * covmean)
       return np.real(fid)
   ```

   * `diff.dot(diff)` ‚Üí squared difference of means.
   * `sqrtm(sigma1.dot(sigma2))` ‚Üí geometric mean of covariance matrices.
   * `np.trace(...)` ‚Üí difference in covariance structure.
   * `np.real()` ‚Üí ensures result is real (since `sqrtm` may give tiny imaginary parts due to numerical error).

2. **Inputs (Random Example)**

   ```python
   mu1, sigma1 = np.random.rand(3), np.eye(3)
   mu2, sigma2 = np.random.rand(3), np.eye(3)
   ```

   * Two sets of random mean vectors (`Œº‚ÇÅ, Œº‚ÇÇ`) and covariance matrices (`Œ£‚ÇÅ, Œ£‚ÇÇ`).
   * Here `np.eye(3)` means identity covariance (no correlation, unit variance).

3. **Output**

   ```
   FID Score: <some value>
   ```

   * Example: `FID Score: 0.78` (random since inputs are random).

---

### 4. Why FID is Important in Generative AI

* Used to measure **how realistic generated images are**.
* Better than older metrics like Inception Score (IS), since it considers both **mean** and **covariance** of feature distributions.
* Standard benchmark for GANs, VAEs, and Diffusion Models.

---

### 5. How It‚Äôs Used in Practice

* Real and generated images are passed through a pre-trained **Inception-v3 network**.
* Extracted features (activations from a deep layer) are used to compute Œº and Œ£.
* FID is then calculated between these two feature distributions.

---

üëâ Do you want me to extend this code to a **practical version that compares two sets of images** (real vs generated) using Inception-v3 features, instead of just random numbers?
